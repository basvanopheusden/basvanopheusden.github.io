#ifndef HEURISTIC_H_INCLUDED
#define HEURISTIC_H_INCLUDED
//#define DEFAULT_WEIGHTS

#include "board.h"
#include <random>
#include <vector>
#include <map>
using namespace std;

const double params[200][10]={{3.00000,0.00550,0.20000,0.02000,0.99999,0.17814,0.68676,0.40000,2.50000,9.57750},
{4.70480,0.47066,0.34341,0.02395,1.49750,0.67879,1.39550,0.25788,6.88700,13.02500},
{2.98500,0.02077,0.23404,0.01492,0.95158,0.64488,1.00770,0.32795,3.75470,7.07190},
{4.74140,0.01327,0.22899,0.01000,1.68090,0.27649,0.44463,0.61712,1.62520,14.24800},
{6.46320,0.00500,0.24270,0.02107,1.17510,0.43932,0.48067,0.29370,3.77030,16.74400},
{2.83890,0.00667,0.34658,0.02000,1.16670,1.06670,0.50709,0.30000,3.33330,15.00000},
{3.22610,0.00407,0.23038,0.02232,1.10150,0.31883,0.69564,0.58696,2.70290,9.36230},
{8.93660,0.00701,0.40324,0.01137,1.72280,1.21420,0.35822,0.12947,4.39660,10.94000},
{1.74480,0.02252,0.20000,0.02846,1.02260,-0.26625,1.04820,0.34074,2.13280,17.03700},
{4.00390,0.00735,0.30000,0.03000,1.00000,0.45810,1.00000,0.30000,3.33330,30.00000},
{4.69530,0.01865,0.33802,0.02207,1.09040,0.59695,0.28619,0.28980,3.68430,14.17400},
{5.05110,0.00367,0.29876,0.02035,1.00930,0.43655,0.78442,0.29731,2.46970,11.80500},
{0.10000,0.01610,0.21696,0.02206,0.51912,0.32808,0.93395,0.46678,3.73120,15.82200},
{8.66670,0.01069,0.37778,0.01954,1.03670,0.71928,1.00000,0.30000,4.65800,11.67700},
{0.10000,0.00100,0.21150,0.02000,1.00000,0.80000,0.81802,0.16628,2.50000,15.00000},
{1.46400,0.01389,0.16425,0.02879,0.77362,0.60878,0.88713,0.73042,3.44760,16.05300},
{0.84579,0.00497,0.19461,0.01838,0.66296,0.40277,0.97366,0.30890,2.54610,20.03500},
{8.45000,0.01046,0.63639,0.01113,1.43050,0.33981,0.44213,0.20208,4.28650,23.49400},
{5.00000,0.01000,0.21111,0.01000,0.50000,0.40000,1.00000,0.00000,3.50000,18.33300},
{3.64480,0.01382,0.28468,0.02012,0.98031,0.60952,1.07510,0.60399,4.98930,15.04900},
{3.00000,0.01118,0.20036,0.02000,0.25000,0.61690,0.04728,0.30000,2.50000,15.00000},
{1.06060,0.02640,0.20000,0.02000,0.95833,0.46600,1.00000,0.30000,2.50000,15.00000},
{3.55000,0.01114,0.20000,0.02000,1.00000,0.80000,0.72045,0.66667,2.50000,15.00000},
{1.24510,0.00100,0.31965,0.01626,1.01110,0.97422,0.82260,0.51336,2.46760,15.14800},
{5.27500,0.01500,0.30000,0.02000,1.12550,0.68178,0.99999,1.00000,2.50000,15.00000},
{1.06670,0.00100,0.25249,0.02010,0.99564,0.80030,0.93053,0.29942,2.74750,19.96000},
{7.00000,0.01891,0.10000,0.01500,1.87900,0.80000,0.63367,0.40000,2.50000,15.00000},
{6.23600,0.00367,0.40097,0.01756,1.01370,0.79951,0.67907,0.29921,3.54830,7.06330},
{2.93620,0.00392,0.20073,0.04405,0.49566,0.45466,0.64779,0.60565,7.75650,36.58300},
{5.01370,0.00846,0.20001,0.03295,1.00400,0.63902,0.59800,0.49740,2.50810,11.70900},
{1.02810,0.00100,0.02829,0.01000,0.56250,0.58315,0.50000,0.62500,2.75930,6.82460},
{4.02480,0.00619,0.18133,0.01576,0.50000,0.20740,1.81200,0.26331,3.90590,20.00000},
{5.00160,0.00399,0.14966,0.01000,0.99900,-0.04881,0.84234,0.22343,3.72990,15.00900},
{1.71030,0.00548,0.30000,0.03248,1.00000,0.80000,0.80000,0.30000,3.50000,15.00000},
{3.36050,0.00700,0.17697,0.02129,0.50058,0.39461,0.93095,0.44060,5.96070,16.60500},
{3.00000,0.00500,0.20089,0.02000,1.00000,0.55113,1.00000,0.40000,3.47770,6.90390},
{1.62530,0.01000,0.30707,0.01000,0.50000,0.80000,0.75471,0.60000,5.00000,19.63600},
{2.50710,0.00437,0.19946,0.02108,0.65293,0.67476,0.82245,0.39680,2.49310,15.03900},
{8.00060,0.00700,0.21990,0.02000,0.99988,0.79988,1.00010,0.29991,3.48730,14.99900},
{3.33180,0.00100,0.11146,0.01840,0.84756,0.31976,0.82293,0.37537,2.55520,7.67810},
{8.00000,0.00100,0.18889,0.01891,0.99691,0.60775,1.00000,0.61729,2.77900,15.92600},
{4.52880,0.00100,0.00000,0.03000,0.25000,0.89160,1.01770,0.36289,3.15760,10.76000},
{3.00000,0.01000,0.18578,0.02000,1.00000,0.80000,1.00000,0.30000,2.50000,15.00000},
{5.00000,0.01000,0.10000,0.03000,1.00000,0.80000,1.00000,0.50000,2.50000,15.00000},
{5.00000,0.00500,0.20000,0.01000,0.25000,0.48243,0.99999,1.46960,2.50000,15.00000},
{5.00000,0.00400,0.20000,0.02000,0.95433,0.90396,1.00000,0.30000,3.33330,15.00000},
{6.00000,0.00100,0.40000,0.02000,1.50000,0.80000,-0.37472,0.30000,2.50000,15.00000},
{0.10000,0.00269,0.12540,0.02000,0.50000,0.79999,1.00000,0.41723,3.30900,30.00000},
{6.85010,0.00100,0.50609,0.01000,1.27520,0.24996,0.42065,0.18801,3.72250,18.99900},
{1.72980,0.01999,0.20729,0.02001,1.05580,0.39979,0.79974,-0.08847,3.95710,22.22000},
{5.85000,0.00500,0.30362,0.02000,0.67594,1.00000,1.00850,0.78037,5.00000,30.00000},
{2.18420,0.00396,0.15959,0.02642,1.00000,0.77574,0.86667,0.31111,2.85030,15.00000},
{8.50000,0.00789,0.20000,0.02304,0.99999,0.42663,0.69097,0.40490,5.00000,8.72640},
{4.72780,0.01000,0.10000,0.02073,0.25000,-0.14747,0.80000,1.17220,3.50000,13.33300},
{3.53960,0.00100,0.07605,0.02001,0.85193,1.18660,0.99891,0.21760,2.22540,29.98900},
{9.50000,0.01022,0.27340,0.02000,1.64050,0.48391,0.65803,0.30000,3.90690,58.74400},
{4.08550,0.00369,0.15455,0.01079,0.96848,1.56430,1.00000,1.06170,3.23460,17.22200},
{3.24860,0.00100,0.20000,0.01000,1.00000,1.06670,1.00000,0.30000,2.50000,10.00000},
{3.55770,0.00891,0.20169,0.03000,1.00000,0.63423,0.61971,0.30000,2.50000,20.00000},
{2.91290,0.00748,0.30319,0.02934,0.71650,0.65617,1.04470,0.32903,6.53870,17.37300},
{3.00000,0.00661,0.24444,0.02000,0.66843,0.51065,1.00000,0.66667,3.33330,15.00000},
{3.20000,0.00733,0.26831,0.01083,1.00000,0.88889,1.00000,0.05993,3.88890,16.61600},
{3.00670,0.00498,0.20137,0.01000,0.80765,0.61767,0.61205,0.29778,4.67440,20.03100},
{3.74300,0.00900,0.04807,0.01000,0.25000,1.02080,1.68200,0.42443,4.20840,17.25000},
{7.62220,0.00100,0.30000,0.01711,1.90280,0.80000,0.09128,0.50000,2.50000,10.00000},
{2.99800,0.00520,0.24639,0.01754,0.90991,0.38357,0.89131,0.34356,3.33150,15.00800},
{5.00000,0.00100,0.40000,0.02290,1.00000,0.80000,1.00000,0.30000,2.50000,20.00000},
{7.00000,0.00593,0.23259,0.02000,1.00000,0.53334,1.00000,0.30000,5.33770,15.00000},
{7.02950,0.00226,0.29075,0.01000,1.12550,0.63994,0.92353,0.28222,4.97430,19.71300},
{4.08630,0.00496,0.27775,0.02004,0.67868,1.67170,0.99497,0.29673,4.68660,24.98000},
{6.43650,0.00452,0.40062,0.01999,1.00060,0.80094,0.47812,0.30557,2.59230,14.99200},
{4.37380,0.00102,0.19963,0.01007,0.56412,1.42500,1.58010,0.04177,3.71870,9.18550},
{9.49010,0.00624,0.39122,0.02311,1.67660,0.82792,0.96558,0.29332,5.09910,30.00000},
{4.82130,0.00500,0.10000,0.01000,0.76649,0.40000,1.00000,0.30000,2.50000,15.00000},
{4.02420,0.00100,0.08550,0.02303,0.97167,-0.34754,1.54050,0.56091,2.44330,16.38100},
{5.00000,0.00122,0.19412,0.03000,0.80407,1.09320,1.50000,0.30000,2.50000,10.00000},
{8.41200,0.00500,0.29940,0.01000,0.80233,0.79998,0.99829,0.15465,5.34030,20.00000},
{4.46580,0.00100,0.20027,0.01000,1.22230,0.75282,1.38430,0.60032,3.33440,15.00600},
{3.40740,0.00500,0.21726,0.02765,0.50000,0.70283,0.80000,0.60000,3.33330,7.15780},
{4.20520,0.00100,0.20000,0.02000,1.00000,0.80000,1.06670,0.50000,3.50000,2000.00000},
{2.48870,0.00100,0.10000,0.02174,0.66814,1.06670,1.00000,0.60000,2.50000,15.00000},
{7.00000,0.00500,0.20000,0.02000,0.93361,0.80000,0.66236,0.30000,3.24040,15.00000},
{0.10000,0.00381,0.10000,0.02000,0.50000,0.80000,1.00000,0.30000,4.66670,15.00000},
{3.40890,0.00379,0.00000,0.01268,0.86446,0.61127,0.56861,0.54821,3.18250,12.20600},
{2.39640,0.00100,0.27035,0.02686,0.98165,0.93788,1.00620,0.25407,3.79620,14.43500},
{1.85650,0.00928,0.10645,0.02453,0.46089,0.76938,0.99272,0.33317,5.41150,68.59600},
{2.80700,0.00100,0.18530,0.01000,0.97766,0.51934,0.97446,0.31238,2.54470,14.79600},
{6.29530,0.00551,0.27137,0.02477,0.44766,0.69485,1.17840,0.53900,9.00780,21.42700},
{2.87040,0.00100,0.10556,0.02000,1.00000,0.80000,1.00000,0.30000,2.50000,15.00000},
{4.14680,0.00100,0.11918,0.01999,0.94574,1.47400,1.25760,0.33353,2.50050,19.99800},
{10.00000,0.00717,0.13708,0.01685,0.86235,0.65842,0.84269,0.19775,2.77530,13.74200},
{4.40970,0.01261,0.22994,0.02011,1.00460,0.80536,1.00600,0.29613,4.98960,20.04800},
{2.86640,0.00100,0.10000,0.01889,1.00000,0.89268,0.87389,0.36338,2.50000,30.00000},
{6.83330,0.00815,0.17904,0.01662,0.25000,0.22221,1.47950,0.33333,4.20070,15.00000},
{5.34990,0.00224,0.09274,0.01000,0.46144,0.95633,1.36900,0.29866,5.00000,15.00000},
{3.49230,0.00100,0.17816,0.01610,0.87157,1.06670,1.12740,-0.35765,2.93230,15.00000},
{6.00000,0.00100,0.15310,0.02000,1.08610,0.80000,1.00000,0.30000,2.50000,15.00000},
{3.57880,0.00479,0.08333,0.02000,0.50000,0.50823,0.92961,0.30000,3.44450,15.00000},
{3.00000,0.00456,0.10746,0.02049,1.00170,0.75576,1.00000,0.65747,2.50000,15.00000},
{4.21580,0.00100,0.09860,0.01679,1.00000,0.42067,0.58309,0.30000,2.50000,15.00000},
{3.00000,0.00100,0.17270,0.01000,0.48519,0.80000,1.00000,0.30000,2.50000,15.00000},
{2.51670,0.00500,0.20000,0.02754,0.57485,0.63830,1.00000,0.60000,7.79930,20.00000},
{7.67020,0.00256,0.09232,0.03004,0.41637,0.70090,0.99910,0.39303,3.80560,14.99300},
{6.92240,0.00100,0.21301,0.02000,1.05700,0.91356,0.77436,0.30000,3.33330,15.00000},
{5.00000,0.00500,0.00000,0.03000,0.50000,0.84822,0.80000,0.41877,2.50000,8.38320},
{7.00000,0.00250,0.20042,0.02333,0.99999,0.80000,0.49593,0.60000,5.00000,15.00000},
{4.30690,0.00100,0.08333,0.04000,1.03920,0.43719,0.80000,0.30000,3.50000,15.00000},
{5.09710,0.00100,0.20427,0.01492,0.44677,0.52681,0.98934,0.29481,3.34710,14.62700},
{1.07850,0.00100,0.00000,0.01667,0.53835,0.69188,1.34150,0.30396,2.81720,14.95100},
{6.88330,0.00203,0.30000,0.02667,0.59046,0.83380,0.88281,0.34444,2.50000,15.00000},
{8.14600,0.00363,0.20000,0.01000,1.00000,0.57985,1.00000,0.10373,5.08210,14.34500},
{2.85270,0.00458,0.09681,0.01934,0.50004,0.94845,0.95838,0.29995,6.10090,20.00100},
{1.82130,0.00994,0.13861,0.01892,0.95973,-0.16857,0.54786,0.83962,3.36370,108.97000},
{6.36750,0.00365,0.22658,0.01000,0.77272,1.03380,0.94060,0.23117,4.08440,12.92200},
{6.85020,0.00100,0.40000,0.02000,1.00000,0.80000,0.65471,0.34157,2.50000,11.63300},
{5.00000,0.00100,0.10000,0.02000,1.00000,0.80000,1.00000,0.30000,3.33330,15.00000},
{10.00000,0.00100,0.21777,0.01484,0.37915,1.04010,0.81439,1.18340,7.04890,12.49500},
{8.82410,0.00100,0.25411,0.01859,0.87197,1.33730,0.79977,0.20482,5.05820,166.42000},
{3.68130,0.00386,0.18132,0.01667,0.49992,0.37579,0.82035,1.69790,9.28390,37.02900},
{2.51670,0.00100,0.04292,0.01000,0.48881,0.40000,1.10040,0.53554,3.33330,180.00000},
{10.00000,0.00234,0.14310,0.02342,0.57818,1.02320,1.24800,0.49869,2.93410,13.01600},
{2.02860,0.00472,0.10693,0.01998,0.49973,1.71570,0.99854,0.49959,5.82520,19.98800},
{3.83260,0.00500,0.21292,0.02000,1.00000,0.80000,0.80000,0.43148,5.00000,30.00000},
{5.27770,0.00100,0.16667,0.01000,0.50000,0.40000,1.24280,0.00001,3.50000,9.99990},
{1.55000,0.00500,0.20000,0.02000,0.50000,0.80001,1.07730,0.40000,5.68540,26.66700},
{5.85150,0.00100,0.16366,0.01758,0.99211,0.63790,0.87560,0.39413,2.48420,8.19220},
{7.00040,0.00100,0.20004,0.03000,1.00010,0.92665,0.79990,0.29993,2.49980,14.99900},
{2.42150,0.00100,0.20338,0.01193,0.46311,0.28359,1.04880,0.32555,7.25320,41.18200},
{8.87450,0.00409,0.10285,0.01857,0.33597,0.76088,1.09120,0.49594,4.71220,6.58720},
{4.20750,0.00100,0.10488,0.01000,0.95498,0.93575,0.99031,0.31963,2.92140,13.34200},
{3.00340,0.00100,0.09843,0.01508,0.68014,0.79292,1.08780,0.67256,3.31960,15.06300},
{3.29420,0.00612,0.00000,0.01000,1.00000,0.40000,1.00000,0.30000,3.50000,15.00000},
{4.18330,0.00100,0.10308,0.01000,0.51509,0.19629,1.17110,0.42075,3.50000,30.00000},
{3.10390,0.00100,0.08313,0.01000,1.00000,0.68253,0.87067,0.30000,3.50000,15.00000},
{10.00000,0.00100,0.20000,0.02369,1.00000,0.80000,0.75151,0.30000,2.50000,20.00000},
{4.52130,0.00100,0.10442,0.01000,0.77109,0.57201,1.42970,0.28827,3.45030,15.02700},
{3.33330,0.00100,0.08488,0.01180,0.57283,0.40000,0.99336,0.22673,3.77570,20.57300},
{6.70200,0.00100,0.13854,0.01554,0.37787,1.04270,1.24330,0.38841,3.24120,17.44500},
{2.77190,0.00354,0.06867,0.02464,0.45602,0.79673,0.89815,0.67522,9.29170,26.56900},
{8.43140,0.00154,0.10898,0.01000,1.51890,2.08900,0.54645,0.68550,2.84030,12.74600},
{2.71610,0.00100,0.09430,0.01000,0.68672,1.19870,0.77599,0.67650,3.36350,10.21100},
{1.10880,0.00803,0.18777,0.02041,0.45864,0.48317,1.44430,0.18025,6.72000,114.23000},
{3.00000,0.00100,0.06312,0.01500,0.50000,0.56684,0.68201,0.50000,3.02910,15.00000},
{2.55000,0.00100,0.10000,0.01600,0.25000,0.80000,1.00000,0.10870,3.50000,15.00000},
{6.00000,0.00233,0.16667,0.01000,1.00000,1.13530,0.99999,0.30000,3.50000,30.00000},
{3.13740,0.00140,0.16667,0.02000,0.51840,1.19390,1.43580,0.30000,3.33330,15.00000},
{9.45770,0.00100,0.21216,0.01110,1.50270,1.11360,1.00620,0.59596,1.70090,7.45200},
{8.84230,0.00100,0.06796,0.02961,1.00850,1.10320,0.99027,0.30632,2.85080,14.92200},
{3.01020,0.00100,0.00001,0.01171,0.64680,0.70588,0.88889,0.50000,7.00000,20.00000},
{10.00000,0.00123,0.21466,0.01000,0.64173,1.04020,1.19970,0.24329,3.68340,13.14000},
{7.22220,0.00100,0.13093,0.01250,1.00000,0.80000,1.00000,0.40000,2.50000,15.00000},
{3.05870,0.00100,0.16667,0.01833,0.34286,0.69115,0.91667,0.24583,3.95520,14.33300},
{5.00040,0.00100,0.24996,0.01757,1.00010,0.80003,0.99988,0.29992,3.33360,14.99900},
{6.00000,0.00100,0.03958,0.01083,0.50000,0.62456,0.59038,0.36404,4.07740,10.00000},
{6.00000,0.00100,0.03958,0.01083,0.50000,0.62456,0.59038,0.36404,4.07740,10.00000},
{6.91100,0.00100,0.19061,0.01529,0.86824,0.86455,1.02040,0.29118,3.40470,14.86400},
{6.91100,0.00100,0.19061,0.01529,0.86824,0.86455,1.02040,0.29118,3.40470,14.86400},
{4.41920,0.00100,0.28786,0.02849,0.30052,0.62864,1.00000,0.30000,3.50000,15.00000},
{2.51670,0.00100,0.01354,0.01703,0.70130,1.12660,0.98271,0.60000,5.00000,30.00000},
{8.01800,0.00100,0.04954,0.01684,1.11510,0.79590,1.00030,0.39704,2.56530,14.96400},
{8.01800,0.00100,0.04954,0.01684,1.11510,0.79590,1.00030,0.39704,2.56530,14.96400},
{10.00000,0.00100,0.26573,0.03263,0.89275,0.66674,0.99245,0.50682,3.60510,16.31500},
{10.00000,0.00100,0.26573,0.03263,0.89275,0.66674,0.99245,0.50682,3.60510,16.31500},
{10.00000,0.00100,0.26573,0.03263,0.89275,0.66674,0.99245,0.50682,3.60510,16.31500},
{8.15470,0.00100,0.06352,0.01833,0.78125,0.35833,0.80434,0.56250,3.74200,28.00000},
{9.72510,0.00100,0.19475,0.02101,0.99762,0.81682,0.82726,0.24531,2.54600,15.23400},
{2.11730,0.00193,0.25071,0.01095,0.42545,0.39260,1.45270,0.59423,4.20780,26.37900},
{3.43280,0.00194,0.05926,0.01982,0.50000,0.80000,1.33330,1.35000,5.37040,28.43200},
{4.09650,0.00100,0.09815,0.02333,0.50000,0.80000,1.24190,0.30000,3.50000,13.12000},
{5.45150,0.00100,0.10000,0.01409,0.82176,0.57429,0.79747,0.30000,3.71920,12.70600},
{7.00000,0.00100,0.10000,0.02000,0.50000,0.80000,0.80000,0.19862,6.12390,20.00000},
{7.97020,0.00130,0.07253,0.02310,0.49586,0.39533,0.80598,0.46224,5.19330,10.08100},
{7.97020,0.00130,0.07253,0.02310,0.49586,0.39533,0.80598,0.46224,5.19330,10.08100},
{3.00000,0.00100,0.10000,0.01000,0.58333,0.69455,0.80000,0.50000,7.00000,20.00000},
{3.00000,0.00100,0.10000,0.01000,0.58333,0.69455,0.80000,0.50000,7.00000,20.00000},
{3.00000,0.00100,0.10000,0.01000,0.58333,0.69455,0.80000,0.50000,7.00000,20.00000},
{3.00000,0.00100,0.10000,0.01000,0.58333,0.69455,0.80000,0.50000,7.00000,20.00000},
{7.00000,0.00100,0.06952,0.01500,1.00000,0.38545,1.00000,0.60000,2.50000,15.00000},
{7.00000,0.00100,0.06952,0.01500,1.00000,0.38545,1.00000,0.60000,2.50000,15.00000},
{7.00000,0.00100,0.06952,0.01500,1.00000,0.38545,1.00000,0.60000,2.50000,15.00000},
{7.00000,0.00100,0.06952,0.01500,1.00000,0.38545,1.00000,0.60000,2.50000,15.00000},
{7.00000,0.00100,0.06952,0.01500,1.00000,0.38545,1.00000,0.60000,2.50000,15.00000},
{7.00000,0.00100,0.06952,0.01500,1.00000,0.38545,1.00000,0.60000,2.50000,15.00000},
{7.00000,0.00100,0.06952,0.01500,1.00000,0.38545,1.00000,0.60000,2.50000,15.00000},
{7.00000,0.00100,0.06952,0.01500,1.00000,0.38545,1.00000,0.60000,2.50000,15.00000},
{8.30060,0.00100,0.17500,0.01097,0.49194,0.74374,1.06250,0.34063,5.79690,15.50000},
{8.30060,0.00100,0.17500,0.01097,0.49194,0.74374,1.06250,0.34063,5.79690,15.50000},
{8.30060,0.00100,0.17500,0.01097,0.49194,0.74374,1.06250,0.34063,5.79690,15.50000},
{8.30060,0.00100,0.17500,0.01097,0.49194,0.74374,1.06250,0.34063,5.79690,15.50000},
{8.30060,0.00100,0.17500,0.01097,0.49194,0.74374,1.06250,0.34063,5.79690,15.50000},
{8.30060,0.00100,0.17500,0.01097,0.49194,0.74374,1.06250,0.34063,5.79690,15.50000},
{6.90390,0.00100,0.20000,0.02000,0.62499,0.48963,1.00000,0.30000,5.00000,15.00000},
{9.99990,0.00100,0.20291,0.01640,0.39246,1.02500,1.36220,0.13750,4.29230,17.00000},
{9.99990,0.00100,0.20291,0.01640,0.39246,1.02500,1.36220,0.13750,4.29230,17.00000},
{9.99990,0.00100,0.20291,0.01640,0.39246,1.02500,1.36220,0.13750,4.29230,17.00000},
{9.99990,0.00100,0.20291,0.01640,0.39246,1.02500,1.36220,0.13750,4.29230,17.00000},
{9.99990,0.00100,0.20291,0.01640,0.39246,1.02500,1.36220,0.13750,4.29230,17.00000},
{9.99990,0.00100,0.20291,0.01640,0.39246,1.02500,1.36220,0.13750,4.29230,17.00000},
{9.99990,0.00100,0.20291,0.01640,0.39246,1.02500,1.36220,0.13750,4.29230,17.00000},
{7.00000,0.00100,0.12994,0.02000,0.94787,0.71338,1.00000,-0.26226,3.89320,15.00000}};

struct pattern{
  uint64 pieces;
  uint64 pieces_empty;
  int n;
  double weight_act;
  double weight_pass;
  double drop_rate;
  int ind;
  pattern(uint64,uint64,int,double*,double*,double*,int);
  bool is_active(board&);
  bool contained(board&);
  bool contained(board&,bool);
  bool just_active(board&);
  bool isempty(uint64);
  uint64 missing_pieces(board&,bool);
  double diff_act_pass();
  void update(double*,double*,double*);
};

class heuristic{
  public:
    static const unsigned int Nweights=17;
    double center_weight;
    double w_act[Nweights];
    double w_pass[Nweights];
    double delta[Nweights];
    unsigned int Nfeatures;
    double D0,K0;
    double stopping_thresh,pruning_thresh,gamma,lapse_rate,opp_scale;
    double exploration_constant;
    bool self;
    int iterations;
    double tree_stats[4];
    vector<pattern> feature;
    vector<pattern> feature_backup;
    map<uint64,double> vtile;
    //vector<pattern> feature_backup2;
    mt19937_64 engine;
    geometric_distribution<int> iter_dist;
    normal_distribution<double> noise;
    bernoulli_distribution lapse;
    heuristic();
    void get_params_from_file(char*,int);
    void get_params_from_file(char*,int,int);
    void get_params_from_matlab(double*);
    void get_params(const double*);
    void get_features_from_file(char*);
    void addfeature(uint64, int );
    void addfeature(uint64, uint64, int , int );
    void update();
    void seed_generator(mt19937_64);
    void update_weights();
    double evaluate(board, zet);
    double evaluate(board);
    vector<zet> get_pruned_moves(board&, bool);
    vector<zet> get_moves(board&, bool, bool);
    zet makerandommove(board,bool);
    zet makemove_bfs(board,bool);
    int playout(board,bool);
    void remove_features();
    void restore_features();
    void eliminate_noise();
};

#endif // HEURISTIC_H_INCLUDED
